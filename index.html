<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Arizona Prime — Подать заявление</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Inter:wght@400;500&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone@7.23.0/babel.min.js"></script>
  <style>
    :root {
      --glass: rgba(255, 255, 255, 0.12);
      --glass-strong: rgba(255, 255, 255, 0.18);
      --glass-border: rgba(255, 255, 255, 0.2);
      --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      --blur: 24px;
      --radius: 20px;
      --radius-sm: 14px;
      --accent: #0a84ff;
      --accent-hover: #409cff;
      --text: rgba(255, 255, 255, 0.95);
      --text-muted: rgba(255, 255, 255, 0.65);
      --bg: #000;
      --bg-gradient: radial-gradient(ellipse 80% 50% at 50% -20%, rgba(120, 119, 198, 0.15), transparent),
                     radial-gradient(ellipse 60% 40% at 80% 50%, rgba(10, 132, 255, 0.08), transparent);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg);
      background-image: var(--bg-gradient);
      color: var(--text);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
    }
    .font-geo { font-family: 'Outfit', sans-serif; font-weight: 600; letter-spacing: -0.02em; }
    .glass { background: var(--glass); backdrop-filter: blur(var(--blur)); -webkit-backdrop-filter: blur(var(--blur)); border: 1px solid var(--glass-border); border-radius: var(--radius); box-shadow: var(--glass-shadow); }
    .glass-btn { display: inline-flex; align-items: center; justify-content: center; padding: 14px 28px; border-radius: var(--radius-sm); border: 1px solid var(--glass-border); background: var(--glass); backdrop-filter: blur(var(--blur)); -webkit-backdrop-filter: blur(var(--blur)); color: var(--text); font-family: inherit; font-size: 1rem; font-weight: 500; cursor: pointer; transition: transform 0.15s, background 0.2s; text-decoration: none; }
    .glass-btn:hover { background: var(--glass-strong); transform: scale(1.02); }
    .glass-btn.primary { background: var(--accent); border-color: transparent; color: #fff; }
    .glass-btn.primary:hover { background: var(--accent-hover); }
    input, select, textarea { width: 100%; padding: 14px 18px; border-radius: var(--radius-sm); border: 1px solid var(--glass-border); background: rgba(255,255,255,0.06); color: var(--text); font-family: inherit; font-size: 1rem; }
    input:focus, select:focus, textarea:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px rgba(10,132,255,0.25); }
    label { display: block; margin-bottom: 8px; font-size: 0.9rem; color: var(--text-muted); }
    .form-group { margin-bottom: 20px; }
    .public-layout { min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 24px 20px 80px; }
    .nav-top { display: flex; flex-wrap: wrap; gap: 12px; justify-content: center; margin-bottom: 48px; }
    .nav-top .glass-btn.active { background: var(--glass-strong); border-color: var(--accent); color: var(--accent); }
    .hero { text-align: center; max-width: 640px; margin: 0 auto 40px; }
    .hero-title { font-size: clamp(2.5rem, 6vw, 3.5rem); margin-bottom: 20px; line-height: 1.1; }
    .hero-sub { font-size: 1.05rem; line-height: 1.6; color: var(--text-muted); margin-bottom: 36px; }
    .cta-wrap { display: flex; justify-content: center; }
    .admin-entry { position: fixed; bottom: 16px; right: 16px; width: 40px; height: 40px; border-radius: 50%; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; color: var(--text-muted); font-size: 18px; text-decoration: none; z-index: 100; }
    .admin-entry:hover { background: rgba(255,255,255,0.12); color: var(--text); }
    .page-content { width: 100%; max-width: 560px; margin: 0 auto; }
    .page-title { font-family: 'Outfit', sans-serif; font-size: 1.75rem; margin-bottom: 24px; text-align: center; }
    .leadership-grid { display: grid; gap: 20px; margin-top: 24px; }
    .leadership-card { padding: 24px; display: flex; gap: 20px; align-items: flex-start; }
    .leadership-avatar { width: 80px; height: 80px; border-radius: var(--radius-sm); background: rgba(255,255,255,0.08); object-fit: cover; flex-shrink: 0; }
    .leadership-info h3 { font-family: 'Outfit', sans-serif; font-size: 1.15rem; margin-bottom: 4px; }
    .leadership-position { font-size: 0.9rem; color: var(--accent); margin-bottom: 8px; }
    .leadership-bio { font-size: 0.95rem; color: var(--text-muted); line-height: 1.5; }
    .admin-layout { min-height: 100vh; padding: 24px; max-width: 900px; margin: 0 auto; }
    .admin-tabs { display: flex; gap: 8px; margin-bottom: 24px; flex-wrap: wrap; }
    .admin-tabs .glass-btn.active { background: var(--glass-strong); border-color: var(--accent); color: var(--accent); }
    .table-wrap { overflow-x: auto; border-radius: var(--radius-sm); border: 1px solid var(--glass-border); background: var(--glass); backdrop-filter: blur(var(--blur)); }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 14px 18px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.06); }
    th { font-weight: 600; font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; }
    tr:last-child td { border-bottom: none; }
    .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); backdrop-filter: blur(8px); display: flex; align-items: center; justify-content: center; z-index: 1000; padding: 20px; }
    .modal { background: rgba(28,28,30,0.95); backdrop-filter: blur(var(--blur)); border: 1px solid var(--glass-border); border-radius: var(--radius); padding: 28px; max-width: 440px; width: 100%; max-height: 90vh; overflow-y: auto; }
    .modal h2 { margin-bottom: 20px; font-size: 1.25rem; }
    .btn-danger { background: rgba(255,59,48,0.9); border: none; color: #fff; }
    .btn-danger:hover { background: rgb(255,59,48); }
    .error-msg { color: #ff6b6b; font-size: 0.9rem; margin-top: 8px; }
    .success-msg { color: #34c759; font-size: 0.9rem; margin-top: 8px; }
    .avatar-placeholder { width: 80px; height: 80px; border-radius: var(--radius-sm); background: rgba(255,255,255,0.08); display: flex; align-items: center; justify-content: center; color: var(--text-muted); font-size: 1.5rem; flex-shrink: 0; }
    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect, createContext, useContext } = React;
    const { createRoot } = ReactDOM;

    const SUPABASE_URL = 'https://qdxzbsrvzlglnxoeofzn.supabase.co'; const SUPABASE_ANON_KEY = 'sb_publishable_48WJcAJ_CpbiX8OMurh5_A_4B-1-N3I'; const SUPABASE_ADMIN_EMAIL = 'prime@arizona-prime.local';
    const supabase = (SUPABASE_URL && SUPABASE_ANON_KEY) ? window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY) : null;

    const LS_APPS = 'ap_applications', LS_LEAD = 'ap_leadership';
    const ADMIN_LOGIN = 'Prime', ADMIN_PASS = 'ArizonaPrime987421&';

    function getPath() { const h = window.location.hash.slice(1) || '/'; return h.startsWith('/') ? h : '/' + h; }
    function usePath() {
      const [path, setPath] = useState(getPath);
      useEffect(() => { const handler = () => setPath(getPath()); window.addEventListener('hashchange', handler); return () => window.removeEventListener('hashchange', handler); }, []);
      const navigate = (to) => { window.location.hash = to.startsWith('/') ? to : '/' + to; };
      return [path, navigate];
    }

    function getApps() { try { return JSON.parse(localStorage.getItem(LS_APPS) || '[]'); } catch { return []; } }
    function saveApps(arr) { localStorage.setItem(LS_APPS, JSON.stringify(arr)); }
    function getLead() { try { return JSON.parse(localStorage.getItem(LS_LEAD) || '[]'); } catch { return []; } }
    function saveLead(arr) { localStorage.setItem(LS_LEAD, JSON.stringify(arr)); }

    const applicationsApi = {
      submit: (data) => supabase ? supabase.from('applications').insert(data).then(r => { if (r.error) throw new Error(r.error.message); }) : (saveApps([...getApps(), { ...data, id: Date.now(), created_at: new Date().toISOString() }]), Promise.resolve()),
      list: () => supabase ? (async () => { const { data: d, error } = await supabase.from('applications').select('*').order('created_at', { ascending: false }); if (error) throw new Error(error.message); return d || []; })() : Promise.resolve([...getApps()].sort((a,b) => new Date(b.created_at) - new Date(a.created_at))),
    };
    const leadershipApi = {
      list: () => supabase ? supabase.from('leadership').select('*').order('sort_order').then(r => { if (r.error) throw new Error(r.error.message); return r.data || []; }) : Promise.resolve(getLead()),
      add: (data) => supabase ? supabase.from('leadership').insert(data).then(r => { if (r.error) throw new Error(r.error.message); }) : (saveLead([...getLead(), { id: Date.now(), ...data, avatar_path: null }]), Promise.resolve()),
      update: (id, data) => supabase ? supabase.from('leadership').update(data).eq('id', id).then(r => { if (r.error) throw new Error(r.error.message); }) : (() => { const l = getLead(); const i = l.findIndex(p => p.id === id); if (i >= 0) l[i] = { ...l[i], ...data }; saveLead(l); })(),
      delete: (id) => supabase ? supabase.from('leadership').delete().eq('id', id).then(r => { if (r.error) throw new Error(r.error.message); }) : saveLead(getLead().filter(p => p.id !== id)),
      uploadAvatar: (id, file) => new Promise((res, rej) => { const r = new FileReader(); r.onload = async () => { const b64 = r.result; if (supabase) { const { error } = await supabase.from('leadership').update({ avatar_path: b64 }).eq('id', id); if (error) rej(new Error(error.message)); } else { const l = getLead(); const i = l.findIndex(p => p.id === id); if (i >= 0) l[i].avatar_path = b64; saveLead(l); } res(); }; r.onerror = () => rej(new Error('Ошибка')); r.readAsDataURL(file); }),
    };

    const AuthContext = createContext(null);
    function AuthProvider({ children }) {
      const [user, setUser] = useState(null);
      const [loading, setLoading] = useState(true);
      useEffect(() => {
        if (!supabase) { if (sessionStorage.getItem('ap_admin') === '1') setUser({ nickname: ADMIN_LOGIN, role: 'admin' }); setLoading(false); return; }
        supabase.auth.getSession().then(({ data: { session } }) => { if (session) setUser({ nickname: ADMIN_LOGIN, role: 'admin' }); setLoading(false); });
        supabase.auth.onAuthStateChange((_, s) => { setUser(s ? { nickname: ADMIN_LOGIN, role: 'admin' } : null); });
      }, []);
      const login = async (password, userData) => {
        if (!supabase) { sessionStorage.setItem('ap_admin', '1'); setUser(userData); return; }
        const { error } = await supabase.auth.signInWithPassword({ email: SUPABASE_ADMIN_EMAIL, password });
        if (error) throw new Error(error.message);
        setUser({ nickname: ADMIN_LOGIN, role: 'admin' });
      };
      const logout = async () => {
        if (supabase) await supabase.auth.signOut();
        sessionStorage.removeItem('ap_admin');
        setUser(null);
      };
      return <AuthContext.Provider value={{ user, loading, login, logout, isAdmin: user?.role === 'admin' }}>{children}</AuthContext.Provider>;
    }
    function useAuth() { const ctx = useContext(AuthContext); if (!ctx) throw new Error('useAuth'); return ctx; }
    function PublicLayout({ path, children }) {
      const is = p => path === p;
      return <div className="public-layout"><nav className="nav-top"><a href="#/" className={`glass-btn ${is('/') ? 'active' : ''}`}>Главная</a><a href="#/anketa" className={`glass-btn ${is('/anketa') ? 'active' : ''}`}>Анкета</a><a href="#/company" className={`glass-btn ${is('/company') ? 'active' : ''}`}>О компании</a><a href="#/leadership" className={`glass-btn ${is('/leadership') ? 'active' : ''}`}>Руководство</a></nav>{children}<a href="#/admin" className="admin-entry" title="Админ">&#x2699;</a></div>;
    }
    function Home() { return <><section className="hero"><h1 className="hero-title font-geo">ARIZONA PRIME</h1><p className="hero-sub">Мы тщательно поддерживаем высокий уровень Role‑Play на всех проектах Arizona Games — здесь каждый персонаж оживает, а сюжеты развиваются естественно. Присоединяйся к нашему сообществу!</p><div className="cta-wrap"><a href="#/anketa" className="glass-btn primary">Подать заявление</a></div></section></>; }
    function Anketa() {
      const [form, setForm] = useState({ game_nickname: '', server_position: '', discord: '', vk_url: '', forum_url: '' });
      const [loading, setLoading] = useState(false);
      const [error, setError] = useState('');
      const [success, setSuccess] = useState(false);
      const handleChange = (e) => { setForm({ ...form, [e.target.name]: e.target.value }); setError(''); };
      const handleSubmit = (e) => { e.preventDefault(); setError(''); setSuccess(false); setLoading(true); applicationsApi.submit({ game_nickname: form.game_nickname.trim(), server_position: form.server_position.trim() || '—', discord: form.discord.trim(), vk_url: form.vk_url.trim(), forum_url: form.forum_url.trim() }).then(() => { setSuccess(true); setForm({ game_nickname: '', server_position: '', discord: '', vk_url: '', forum_url: '' }); }).catch(err => setError(err.message)).finally(() => setLoading(false)); };
      return <div className="page-content"><h2 className="page-title font-geo">Анкета</h2><form onSubmit={handleSubmit} className="glass" style={{ padding: '28px' }}><div className="form-group"><label>Игровой никнейм *</label><input name="game_nickname" value={form.game_nickname} onChange={handleChange} placeholder="Ваш ник" required /></div><div className="form-group"><label>Должность на сервере *</label><input name="server_position" value={form.server_position} onChange={handleChange} placeholder="— если нет" /></div><div className="form-group"><label>Discord</label><input name="discord" value={form.discord} onChange={handleChange} /></div><div className="form-group"><label>ВКонтакте</label><input name="vk_url" value={form.vk_url} onChange={handleChange} type="url" /></div><div className="form-group"><label>Форум</label><input name="forum_url" value={form.forum_url} onChange={handleChange} type="url" /></div>{error && <p className="error-msg">{error}</p>}{success && <p className="success-msg">Заявление отправлено.</p>}<button type="submit" className="glass-btn primary" style={{ width: '100%', marginTop: 8 }} disabled={loading}>{loading ? 'Отправка…' : 'Отправить'}</button></form></div>;
    }
    function Company() { return <div className="page-content"><h2 className="page-title font-geo">О компании</h2><div className="glass" style={{ padding: '28px' }}><p style={{ marginBottom: 16, lineHeight: 1.65, color: 'var(--text-muted)' }}><strong style={{ color: 'var(--text)' }}>Arizona Prime</strong> — часть экосистемы Arizona Games. Мы создаём условия для качественного Role‑Play. Заполни анкету через «Подать заявление» — рассмотрим каждую заявку.</p></div></div>; }
    function Leadership() {
      const [list, setList] = useState([]);
      const [loading, setLoading] = useState(true);
      useEffect(() => { leadershipApi.list().then(setList).catch(() => setList([])).finally(() => setLoading(false)); }, []);
      if (loading) return <div className="page-content"><h2 className="page-title font-geo">Руководство</h2><p style={{ color: 'var(--text-muted)' }}>Загрузка…</p></div>;
      return <div className="page-content"><h2 className="page-title font-geo">Руководящий состав</h2><div className="leadership-grid">{list.length === 0 ? <p style={{ color: 'var(--text-muted)' }}>Список пуст.</p> : list.map(p => <article key={p.id} className="glass leadership-card">{p.avatar_path ? <img src={p.avatar_path} alt="" className="leadership-avatar" /> : <div className="avatar-placeholder">?</div>}<div className="leadership-info"><h3>{p.name}</h3>{p.position && <p className="leadership-position">{p.position}</p>}{p.bio && <p className="leadership-bio">{p.bio}</p>}</div></article>)}</div></div>;
    }
    function AdminLogin({ navigate }) {
      const [nickname, setNickname] = useState('');
      const [password, setPassword] = useState('');
      const [error, setError] = useState('');
      const [loading, setLoading] = useState(false);
      const { login } = useAuth();
      const handleSubmit = async (e) => {
        e.preventDefault(); setError(''); setLoading(true);
        try {
          if (nickname === ADMIN_LOGIN && password === ADMIN_PASS) {
            await login(password, { nickname: ADMIN_LOGIN, role: 'admin' });
            navigate('/admin');
          } else setError('Неверный логин или пароль');
        } catch (err) { setError(err.message || 'Ошибка входа'); }
        setLoading(false);
      };
      return <div className="public-layout"><div className="glass" style={{ maxWidth: 400, padding: 32, marginTop: 40 }}><h1 className="font-geo" style={{ marginBottom: 24, textAlign: 'center' }}>Вход для администратора</h1><form onSubmit={handleSubmit}><div className="form-group"><label>Логин</label><input type="text" value={nickname} onChange={e => setNickname(e.target.value)} required /></div><div className="form-group"><label>Пароль</label><input type="password" value={password} onChange={e => setPassword(e.target.value)} required /></div>{error && <p className="error-msg">{error}</p>}<button type="submit" className="glass-btn primary" style={{ width: '100%', marginTop: 8 }} disabled={loading}>{loading ? 'Вход…' : 'Войти'}</button></form><p style={{ textAlign: 'center', marginTop: 20 }}><a href="#/" className="glass-btn" style={{ display: 'inline-block' }}>На главную</a></p></div></div>;
    }
    function AdminDashboard() {
      const { user, isAdmin, logout } = useAuth();
      const [tab, setTab] = useState('applications');
      const [applications, setApplications] = useState([]);
      const [leadership, setLeadership] = useState([]);
      const [loading, setLoading] = useState(true);
      const [modal, setModal] = useState(null);
      const [form, setForm] = useState({ name: '', position: '', bio: '', sort_order: 0 });
      const [error, setError] = useState('');
      const [saving, setSaving] = useState(false);
      const loadApps = () => applicationsApi.list().then(setApplications).catch(() => setApplications([]));
      const loadLead = () => leadershipApi.list().then(setLeadership).catch(() => setLeadership([]));
      useEffect(() => { if (!isAdmin) return; setLoading(true); Promise.all([loadApps(), loadLead()]).finally(() => setLoading(false)); }, [isAdmin]);
      useEffect(() => { if (tab === 'applications') loadApps(); else loadLead(); }, [tab]);
      useEffect(() => { const h = () => { loadApps(); loadLead(); }; window.addEventListener('storage', h); return () => window.removeEventListener('storage', h); }, []);
      const openAdd = () => { setForm({ name: '', position: '', bio: '', sort_order: leadership.length }); setModal('add'); setError(''); };
      const openEdit = (p) => { setForm({ id: p.id, name: p.name, position: p.position || '', bio: p.bio || '', sort_order: p.sort_order ?? 0 }); setModal('edit'); setError(''); };
      const save = async () => { setError(''); setSaving(true); try { if (modal === 'add') await leadershipApi.add({ name: form.name, position: form.position, bio: form.bio, sort_order: form.sort_order }); else await leadershipApi.update(form.id, { name: form.name, position: form.position, bio: form.bio, sort_order: form.sort_order }); loadLead(); setModal(null); } catch (e) { setError(e.message); } finally { setSaving(false); } };
      const del = async (id) => { if (!confirm('Удалить?')) return; await leadershipApi.delete(id); loadLead(); setModal(null); };
      const uploadAv = (id, file) => { if (file) leadershipApi.uploadAvatar(id, file).then(loadLead).catch(setError); };
      if (!isAdmin) return <div className="admin-layout"><p className="error-msg">Недостаточно прав.</p><button className="glass-btn" onClick={logout}>Выйти</button><a href="#/" className="glass-btn" style={{ marginLeft: 8 }}>На главную</a></div>;
      return <div className="admin-layout">
        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 24, flexWrap: 'wrap', gap: 12 }}>
          <h1 className="font-geo" style={{ fontSize: '1.5rem' }}>Панель администратора</h1>
          <div style={{ display: 'flex', gap: 8, alignItems: 'center' }}>
            <span style={{ color: 'var(--text-muted)', fontSize: '0.9rem' }}>{user?.nickname}</span>
            <button className="glass-btn" onClick={logout}>Выйти</button>
            <a href="#/" className="glass-btn">На сайт</a>
          </div>
        </div>
        <div className="admin-tabs">
          <button className={`glass-btn ${tab === 'applications' ? 'active' : ''}`} onClick={() => { setTab('applications'); loadApps(); }}>Заявления</button>
          <button className={`glass-btn ${tab === 'leadership' ? 'active' : ''}`} onClick={() => { setTab('leadership'); loadLead(); }}>Руководство</button>
          <button className="glass-btn" onClick={() => { loadApps(); loadLead(); }} style={{ marginLeft: 'auto' }}>Обновить</button>
        </div>
        {loading ? <p style={{ color: 'var(--text-muted)' }}>Загрузка…</p> : tab === 'applications' ? (
          <div className="table-wrap"><table><thead><tr><th>Никнейм</th><th>Должность</th><th>Discord</th><th>ВК</th><th>Форум</th><th>Дата</th></tr></thead><tbody>
            {applications.length === 0 ? <tr><td colSpan={6} style={{ color: 'var(--text-muted)' }}>Нет заявлений</td></tr> : applications.map(a => <tr key={a.id}><td>{a.game_nickname}</td><td>{a.server_position}</td><td>{a.discord || '—'}</td><td>{a.vk_url ? <a href={a.vk_url} target="_blank" rel="noopener">Ссылка</a> : '—'}</td><td>{a.forum_url ? <a href={a.forum_url} target="_blank" rel="noopener">Ссылка</a> : '—'}</td><td>{new Date(a.created_at).toLocaleDateString('ru')}</td></tr>)}
          </tbody></table></div>
        ) : (
          <><button className="glass-btn primary" onClick={openAdd} style={{ marginBottom: 20 }}>Добавить в руководство</button>
          <div className="leadership-grid">{leadership.map(p => <div key={p.id} className="glass leadership-card" style={{ justifyContent: 'space-between', alignItems: 'center' }}><div style={{ display: 'flex', gap: 20, alignItems: 'center', flex: 1 }}><label style={{ cursor: 'pointer' }}>{p.avatar_path ? <img src={p.avatar_path} alt="" className="leadership-avatar" /> : <div className="avatar-placeholder">?</div>}<input type="file" accept="image/*" style={{ display: 'none' }} onChange={e => { const f = e.target.files?.[0]; if (f) uploadAv(p.id, f); e.target.value = ''; }} /></label><div className="leadership-info"><h3>{p.name}</h3>{p.position && <p className="leadership-position">{p.position}</p>}{p.bio && <p className="leadership-bio" style={{ maxWidth: 400 }}>{p.bio}</p>}</div></div><div style={{ display: 'flex', gap: 8 }}><button className="glass-btn" onClick={() => openEdit(p)}>Изменить</button><button className="glass-btn btn-danger" onClick={() => del(p.id)}>Удалить</button></div></div>)}</div></>
        )}
        {modal && <div className="modal-overlay" onClick={() => setModal(null)}><div className="modal" onClick={e => e.stopPropagation()}><h2>{modal === 'add' ? 'Добавить' : 'Редактировать'}</h2><div className="form-group"><label>Имя</label><input value={form.name} onChange={e => setForm({ ...form, name: e.target.value })} /></div><div className="form-group"><label>Должность</label><input value={form.position} onChange={e => setForm({ ...form, position: e.target.value })} /></div><div className="form-group"><label>О сотруднике</label><textarea value={form.bio} onChange={e => setForm({ ...form, bio: e.target.value })} rows={3} /></div><div className="form-group"><label>Порядок</label><input type="number" min={0} value={form.sort_order} onChange={e => setForm({ ...form, sort_order: parseInt(e.target.value, 10) || 0 })} /></div>{error && <p className="error-msg">{error}</p>}<div style={{ display: 'flex', gap: 8, marginTop: 16 }}><button className="glass-btn primary" onClick={save} disabled={saving}>{saving ? 'Сохранение…' : 'Сохранить'}</button><button className="glass-btn" onClick={() => setModal(null)}>Отмена</button></div></div></div>}
      </div>;
    }
    function AdminRoute({ navigate }) { const { user, loading } = useAuth(); if (loading) return <div className="public-layout" style={{ justifyContent: 'center' }}><p style={{ color: 'var(--text-muted)' }}>Загрузка…</p></div>; if (!user) return <AdminLogin navigate={navigate} />; return <AdminDashboard />; }
    function App() {
      const [path, navigate] = usePath();
      const norm = (path === '' || path === '/') ? '/' : path.replace(/\/+$/, '') || '/';
      if (norm === '/admin' || norm === '/login' || norm === '/admin-panel') return <AuthProvider><AdminRoute navigate={navigate} /></AuthProvider>;
      let Page = Home;
      if (norm === '/anketa') Page = Anketa;
      else if (norm === '/company') Page = Company;
      else if (norm === '/leadership') Page = Leadership;
      return <AuthProvider><PublicLayout path={norm}><Page /></PublicLayout></AuthProvider>;
    }
    createRoot(document.getElementById('root')).render(<React.StrictMode><App /></React.StrictMode>);
  </script>
</body>
</html>


